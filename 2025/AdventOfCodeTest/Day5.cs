namespace AdventOfCodeTest;

public class Day5
{
    public const string SampleData =
        "3-5\n10-14\n16-20\n12-18\n\n1\n5\n8\n11\n17\n32";

    public const string PuzzleData =
        "514636401848126-515021264549070\n284036251378482-284592982874520\n296164416018017-299046449889301\n283426891017632-284036251378482\n343608343658787-349486968016855\n518754439264536-519443780540781\n203443194067628-203933432910977\n519443780540781-519633512362687\n210005855985412-210549428703488\n282811585081172-283522815708147\n282103439366027-282811585081172\n146191319211378-148928182943279\n542009870509829-542009870509829\n285110984007607-285557627386426\n181836090026423-187133491027023\n191383217925987-193740672523902\n529067077613194-530556181878483\n304959261875505-310322684117777\n5221298087814-5845643808551\n121449485422025-121449485422025\n288819540858543-289732112842441\n31314012134697-34077678147946\n355346276508449-356961978424786\n210005855985412-210154987714222\n31314012134697-38289146357504\n57372486536812-58906664319153\n63107431158211-64549017086535\n4590169517791-5221298087814\n50650192430993-52130829319473\n530953193123290-532382284125787\n265252883201638-269190040850024\n496653674559961-496653674559961\n525886102629992-527695520308656\n234586469402843-238198950451156\n519633512362687-520345553919679\n384980372022383-389006578880062\n317844855413056-320364244125646\n503139165919699-507064243567239\n463493316343339-469362738286899\n43073032066090-49251433333982\n6600924130212-7444318394218\n111838895260979-117094893375877\n7648228942274-7897731755256\n84776658354341-90046495985385\n11562463563199-18329087766001\n313521138229416-320364244125646\n193977202606502-196647888828768\n530153466102565-531523921526216\n553391357437896-562488274516946\n459525942526207-459525942526207\n53393578131918-54955075378575\n404190643739100-408213916357702\n520945760876904-521172857358597\n2727821450473-3340299640579\n286048130453075-286665795820799\n528177694307708-529471263275682\n301956083638360-307163599509656\n507064243567240-511953396823239\n260061486329253-260061486329253\n101450700607317-106472683347649\n544317206779689-552355052009161\n283196635166397-283522815708147\n288819540858543-289732112842441\n131234255850576-137062902674911\n352070211023717-353583840322516\n520186230488106-520945760876904\n415995383355085-415995383355085\n395615962419343-397864940668161\n94366474861793-99527846051448\n205173320654056-206051449292310\n58711690964932-59879231977934\n519633512362687-520345553919679\n516022119170784-516365566181711\n238198950451157-238198950451157\n206639071565785-207304603090383\n518602829412794-519443780540781\n82147453568207-84776658354339\n23956737879583-28622963935851\n484025043897742-489248708112258\n544317206779688-544317206779688\n340128853274594-340128853274594\n444827419361595-451800098044043\n294297486844512-296164416018016\n176240640987270-178847650802940\n192995036697202-195029211979726\n404190643739100-408213916357702\n423420802261041-430543339190155\n438096745586433-440661544775439\n516668731856740-516826848891136\n289079205608282-289927106556831\n515546891366899-516365566181711\n56576870014158-58238248382778\n523020705694172-524681162845767\n432699609410984-440661544775439\n73622261592470-78368864856562\n203615147167346-203933432910977\n252433626704883-260061486329253\n415995383355086-418601199927456\n225742115230077-227522359650710\n536745635162015-542009870509829\n208725672081644-208995628405837\n328742269957098-328742269957098\n163318839464148-163318839464148\n242450869652517-250877827576819\n496653674559961-498166797604837\n353406104646330-355006194373241\n207866368794809-208446995196529\n1708595883983-1909532685738\n360121938111677-361422333382878\n173867301639925-176240640987268\n181836090026423-188217989877988\n206944308839538-207304603090383\n101450700607316-101450700607316\n222235372532517-229028822916590\n142908285233132-146191319211377\n354320242004358-355829534227523\n46225481831810-49251433333982\n358708341359993-360462576296801\n1909532685738-2356756942759\n459010164236-822787238930\n52595367244327-53842968937424\n526841632481036-528402608506153\n284592982874520-284889275037951\n198480173290999-200502677914655\n206051449292310-206639071565785\n553391357437896-559252440639087\n213282678483051-217578951006125\n336185428498850-340128853274593\n121449485422025-129884332810178\n356409937299519-358284721371764\n362754678790488-368199822970279\n51349595474361-52880663948995\n163318839464149-167177497489124\n375764731455726-379099669341280\n372528206409103-375764731455724\n283522815708147-283904486146961\n444827419361595-451800098044043\n3811607178621-4081675716328\n154354622006539-157453469587934\n517803425605817-518054191542013\n426576897630361-429161675325908\n284889275037951-285337573624635\n111838895260979-117094893375877\n272614047343400-277766344260508\n392633898190960-400562908625803\n137062902674912-137062902674912\n247628951587102-250877827576819\n466773209641268-471334211762712\n285557627386426-286298272038457\n282557763450697-283426891017632\n2813781325022-3627969709652\n524077645740986-525409953554452\n197098088554829-199433303049802\n54481491520234-55965788224234\n456199144939177-459525942526206\n474922814171466-476551147548164\n14558671052767-16713866144325\n92219205556280-97580264143478\n283426891017632-284036251378482\n55460508141658-56966989766365\n282557763450697-283426891017632\n287379516759852-287963386979452\n64549017086536-69089566650446\n206051449292310-206470060622464\n384980372022383-384980372022383\n525084947593291-526380411135762\n476551147548166-480592004834004\n78368864856562-78368864856562\n286048130453075-286298272038457\n325663773852006-328742269957098\n343608343658787-346343013406331\n154354622006539-154354622006539\n283196635166397-283904486146961\n215411212460336-220375303342442\n517803425605817-518352016878202\n265252883201638-269190040850024\n195877371240788-197931294682307\n357924716181756-359488291571889\n\n278402555432346\n132663185371131\n308642641112043\n33559341434412\n405303123438474\n485951992574145\n313064131630188\n260158596036936\n88167936209309\n172542568004197\n458979566798645\n326040316021558\n441814331976477\n15242696475530\n532409453906558\n264386719516534\n462500896724966\n31810962837711\n376074010339133\n296957769366533\n214356649810920\n391352103109617\n397015393429102\n209254749760423\n396869971040626\n492567648450273\n74223735388468\n235765509681740\n393369865380685\n354084263929807\n29151194853127\n331213306580185\n200775948660881\n184162024247630\n73539350853939\n119830435623787\n27248780736717\n273944736921943\n298748652980771\n299124411214164\n505045728033385\n465052402342861\n114174482868245\n59857080667886\n385740132696595\n80006398406086\n164797560065538\n449676350447067\n331107394599031\n329904479261567\n28661521864528\n241775855437174\n70075146805242\n100377917697325\n320925037686437\n240701225007949\n71167017443884\n409486741604745\n213210388272121\n193305527209317\n454232214381698\n373477528355225\n107915765152720\n484093453725123\n384598203260425\n87692352508770\n287601254688301\n245281846783672\n346938039089651\n268195944549448\n161737144675390\n263926978453657\n399878538434895\n480794774065006\n528604895528697\n140772160424647\n72063884537085\n324924109510539\n232186650292489\n287021682047962\n119395417223177\n63888428378797\n47703189063136\n128421895159085\n145092004217697\n545399776926267\n551091745204299\n324205236371585\n142734991670084\n138011721050796\n29106037358317\n285779273281918\n544729165988472\n278655342638262\n431782774238901\n274987201312127\n482150377119121\n532329225332989\n230886711948544\n277742281856869\n542469937573351\n110928323185174\n406956845060793\n392495345988528\n373156790449365\n28897120503935\n555056437619844\n288282240953804\n233071070092757\n535916810866149\n202318644863533\n274044733613351\n445204650220846\n562599592138838\n484891673726876\n397310529392326\n51152753289229\n221691413891037\n430268065726843\n292727401143432\n148174775882288\n541971954149702\n230205232252218\n394846657281655\n258961064557207\n168538135912262\n306892797457040\n41143047884962\n263909135855905\n555322955749641\n254690587424659\n414433873970870\n24119954815073\n105258178545862\n51575143573061\n129106627117303\n374522807056431\n447497507528143\n223506299719559\n467044350364998\n107409890260230\n503048129804246\n419888793709599\n223670494400224\n254116980329454\n140949814523698\n361281828985173\n52452532098109\n134884440069559\n454230992392750\n513793320462354\n143974081539492\n301367706287735\n112278821902328\n78129336797298\n70183930773340\n113803338297946\n473304604596770\n461769367861589\n357444038347590\n464409465642740\n169918162583622\n381412251915951\n78436010713279\n74247991214850\n294408435111807\n539136654561650\n374103328543636\n211026210839033\n457850304567788\n322287802901955\n393893358183306\n189132199406123\n482062087499501\n119105849679363\n506514462708219\n134680768346040\n174484013026133\n314742387120658\n234825446647221\n526814730910876\n405094103017447\n552239665074466\n487198509367609\n543612878502850\n245955810359582\n138188761104744\n124126125471817\n561823724773957\n129469363656788\n177468379111918\n241039809480056\n550066267667976\n219843124814009\n462720788415678\n274618609488050\n364147995137340\n278379015579457\n340585878842776\n350875903168946\n331070729467974\n100327817295410\n141147271521536\n351926657214835\n262919286473957\n386199840114074\n53393671829457\n379586140154652\n491620501293264\n249990257576572\n64519244313495\n184847470149212\n89126789338975\n544825673728682\n274803776293650\n153834366278901\n435022235924159\n173873826434726\n59042972581418\n148219795626852\n444346667071188\n475532278427376\n507142501942950\n100854211818626\n47917266954190\n288864792760325\n8989755789362\n128822889809511\n478526536303692\n31049864185284\n1587848580816\n147372848518905\n8157614781088\n10988325260280\n449440693245530\n202957505221201\n468146580196327\n341156307953798\n330457556390284\n119275777031453\n157293448767060\n517712624111396\n83382707578378\n211798817670718\n403812991504731\n52438345000658\n141602527034518\n209814406404292\n288892296326853\n278940982316157\n161337794616069\n193325468633700\n385876393717156\n308588158065137\n200934729386951\n307804488538044\n112310131645211\n407549193596788\n347309160609625\n277807738036876\n1124741478798\n181850807389162\n87340536548673\n108917779897587\n409088291844305\n7327968226076\n331409906632409\n55018818407287\n135959244326713\n255607337735622\n404990318863556\n252681084988887\n502726075212134\n376076478146492\n447466454412473\n257429453228785\n252531857544466\n223649896206420\n99921279410798\n289191726250755\n87940639643249\n291657704833929\n250707386270082\n305532517235714\n457845768362257\n499633834016084\n414660722808058\n115185592261478\n323695771212749\n53067690857484\n164312891564458\n184608065212843\n404061324161713\n546670579412106\n34185905019669\n517810909767627\n318928880485847\n57145094982366\n185136468761899\n123803278607569\n275181571671734\n505187529712629\n238513631615170\n150637997035758\n60696159914228\n509153087482532\n143960871978648\n532742283360955\n321896467398818\n78923110493982\n319410013097706\n374545822434791\n329978068684180\n546234683333382\n518615064982021\n265458933753218\n282556850446800\n556536919099390\n408821451178422\n550450331006822\n387020961781675\n392293780264327\n108001809829709\n541151472944936\n372695991295080\n179700539466037\n130945353612610\n29145725683464\n329997728133242\n446881378976432\n127076551811482\n17299891883245\n159462273043256\n393020453645122\n481706204119683\n382389483886370\n423730095802717\n303184318437817\n365797078969040\n209007197844304\n247220926807876\n264292571087588\n135295985727166\n473540877207725\n42383569639867\n284148851920777\n459839683672452\n29598628425336\n92458461620063\n31618483157264\n185648070289563\n98984221426980\n327261545504740\n339544125209591\n351523051242673\n503549480739263\n451133172113710\n198137406661747\n206433566752702\n323117582234084\n402246977646126\n333793124009912\n98992932009061\n501628586740342\n94911549846737\n325461668807707\n130688966388691\n415706162750143\n431795300584506\n551496845169982\n47236321942328\n245545983075020\n110817343051994\n249570412216764\n374802975869957\n325600137603466\n295130410119795\n365918011942534\n22696813705554\n56381928509742\n322479977663160\n328995696233853\n393181808509923\n486543754315217\n384770321822425\n434901434482810\n209992693025500\n35175387586406\n30890674797432\n329334211904446\n95416474896760\n369941677173765\n408776374541039\n463328601327576\n352193059714251\n515561825104149\n509085802605817\n289033271841082\n284129612437330\n128877515059923\n11710783019097\n134496055286541\n318240924531146\n257570046738609\n104319616549205\n89453172689676\n296422863501405\n272224036719966\n403967683900289\n208395071342657\n306101872949874\n120029032017318\n361623195531845\n248456545529726\n314657311386942\n561664993912685\n365060228244264\n20958161702758\n248843859686259\n200203858186422\n6136051960313\n10355251433495\n64511549654450\n55163120105713\n549156964833318\n321255232483566\n302170372255759\n533118918134213\n147734475468464\n531959177379478\n482924799913380\n369403215999109\n517854494165516\n30763624515305\n7116155983626\n82446528448816\n462227031945577\n179818584376189\n123434101955415\n216299405959612\n46271087218668\n463013904377275\n273259685222153\n491125748072723\n448512985842556\n196859191340249\n252832456458708\n442160277872053\n524958983300282\n390106990435196\n129663515108030\n5622352673985\n257173052193326\n239287224626983\n120562509703631\n274159882479959\n228371247154455\n80267049091762\n382314795358348\n529415203479662\n459858722387131\n264282200528651\n75151228174069\n82951634913109\n342763415768211\n28971157275146\n60472601493332\n276337537927196\n351969714938165\n562587650705150\n297284704851148\n499285017085531\n324125551256360\n392206072182703\n35713645611554\n183126895651293\n424679526469974\n271552485627674\n158719592578564\n471693342183649\n97426653934358\n40613102488781\n371993554902223\n114458195370676\n219355431601203\n250239066927683\n376186023004647\n60722752493741\n463087018526652\n34201411990755\n345550248000346\n211780373002897\n169234342894556\n192841149843724\n100042399395284\n111437480645508\n452954711661644\n245907180732031\n418641728926307\n147960464589869\n33233317907622\n473530477343507\n136008282418109\n105521325435126\n487250089102014\n513133744508381\n264552966427013\n176071042788430\n268961848299179\n119949783203076\n51903620717392\n364379781128387\n131580485824532\n344131994194304\n418295349123048\n136697151966550\n548004430449314\n344380637925610\n295135201549386\n155783901147440\n265375979957582\n110702726863666\n475146284606014\n528156187870536\n206423623361985\n320983281821409\n32308190883767\n445953790831068\n280339418761001\n431229011831650\n46684003610056\n38399734614755\n281215185501015\n273353978839061\n449133569775397\n94595686369921\n175731354902944\n21307525454258\n9489987407002\n172412146731026\n193850453491238\n19446253288803\n285378598978585\n135951933336291\n480773983458421\n552984670280393\n261970498485095\n144592737060723\n138116131924687\n460915272940883\n84482553628168\n174659735669386\n404736756586967\n231412765264382\n411604040108554\n172738598023485\n394223174139584\n163258717553805\n53736088706942\n266563475927420\n390310434289887\n83706278003247\n396738905795074\n278225826503322\n191082728745913\n266651846055938\n492508384095809\n316296449653752\n343106511714695\n210459733293601\n233031956892925\n76418270871678\n29769627349822\n556381730568057\n257012482652597\n248840481200902\n222958858307134\n84042322564436\n35720953789269\n260547639489491\n182683830490502\n36952171920209\n307732212279124\n163247408905762\n435855157710622\n318189444743170\n103870743821491\n312285224574605\n98654666776816\n489010975151168\n399507638671271\n365893303170644\n6908925999420\n393324878695594\n383316081935321\n148738496718000\n52774828932456\n296650357872477\n80337082594428\n269671017806274\n55920709856139\n495013170752544\n561155374851795\n338945539513000\n156445561127481\n409561529233480\n484226615652481\n192448259839345\n481903333391252\n264212783399038\n353174725814555\n96222086088154\n493177058134893\n142723498613148\n510045939338343\n213082967590207\n451414930130011\n287178562027706\n35874332629426\n423663996970455\n88932640030339\n898865885810\n366568691213396\n93353448826935\n108107203011512\n484400437194786\n548596042489566\n529313056823226\n463540798359816\n300970233625678\n533498899750362\n134719012789179\n97353115132835\n140521188335366\n445672791299124\n123320177593172\n216791781266638\n119134890365880\n221205354293267\n184784974544773\n179139368257981\n272193704994870\n170024298461309\n271291402037580\n197907060425420\n420240113592691\n414603513638433\n250476880188896\n420090525955459\n61717209916128\n48894483980599\n377367325324804\n172567330529867\n368761772868553\n243859097661139\n116238986487276\n481244946660263\n128604756311656\n247732487283249\n425716677005089\n286601334753733\n361697552270269\n332491437490283\n371464644131715\n359812466559957\n293124187798925\n370182692549338\n402836813601382\n164523843452144\n245507429744801\n26733519594785\n546495124583763\n54555721459701\n198117667481074\n348191326815994\n184329200281240\n539356383362926\n84656623890568\n258149845295513\n209516619356014\n410555079429028\n161984645206044\n357193302837692\n177148646246335\n79841196917799\n4868559382286\n402367850249728\n362642247369303\n478292748379088\n473744859329195\n82709011229711\n524705537585961\n511883694500252\n57879549575559\n73479392417576\n349000443868403\n486425967984117\n323320630688457\n532783358104403\n50005892324280\n10448553976733\n555289371666192\n179277875998235\n295489636648645\n281583361605010\n319406015645873\n209154331723171\n252336179080392\n220101468243703\n123423381556053\n249424456885568\n142214490657924\n394722317410561\n197456057951525\n548966841451350\n266746513524031\n139098093873876\n466273909877373\n312345615912482\n458924144953335\n445118920882541\n24234079914386\n362088150037853\n460399844392608\n111163631417516\n506849603803255\n532375417265875\n187870869665168\n278574590109391\n202009760679628\n266496090594638\n88270214836837\n561632831464762\n76021467178330\n187623147965793\n357276166666099\n166068895666405\n188702242445761\n482351061167209\n391289279201523\n520990493507818\n497475469916\n339228708691089\n495434152189714\n516949693658243\n131555860183160\n481541018788302\n295012343119003\n120501704104067\n165640591375618\n529132580016293\n277893188385960\n269777289670590\n159109932761167\n455564136979615\n188185367614591\n350833577764253\n557233591767987\n123761048587147\n151314215719767\n477449342398537\n62831624082314\n234848279993236\n430602997047715\n405246019124706\n464912511081924\n197393908639185\n291554048390173\n226121989951378\n212676557405587\n554655885820685\n299727225116809\n407472777371527\n420362905416978\n296266044226918\n58192476181379\n121583520951625\n180106397580363\n260200116504662\n498917279509807\n297365431128272\n313584997350275\n456939228573020\n294370795539257\n449502356758512\n312894062722575\n216863658149932\n549519029638937\n491172219037448\n385632358076595\n203419042895174\n180179598866078\n432578305088914\n210183865431187\n388350948160814\n496476163009942\n345666993119293\n445972232903888\n492968915961196\n321236953037237\n272000749564280\n533278028352087\n6448234606804\n255371133551395\n281168111236994\n329978895797265\n81518297099960\n516583473847205\n473238890315554\n312390116937975\n428025089774473\n302568806855463\n442737529200618\n53628674268291\n559025617844995\n335152898280854\n335195085857352\n128606928001719\n539405453793625\n5091586482817\n368211480784205\n72528232324196\n192747744975660\n495687218221476\n244535070342225\n204542989872716\n333607935179787\n460896301612722\n229112968047752\n391421680374751\n110507896326982\n299550929112341\n457383042303170\n307772312034787\n442036711139656\n302535233032398\n386186344798926\n262893592415689\n372413274467022\n279479327522831\n13437891268612\n506325313609980\n131236709875043\n464308682311645\n411378982136999\n120230773754944\n423195153134786\n405990565834555\n534776597763966\n437411109031200\n219742760290494\n228865825066033\n515184891428578\n488544471552241\n269300858458577\n371478928400050\n130159606369408\n287272634734329\n461905672458027\n60329891379141\n60132187294951\n99521362347276\n309350255318622\n510729754639616\n547692850287734\n294380662401067\n310564837887649\n443429135254524\n225864458441609\n204476139942432\n157661558341040\n522328233479084\n108698387051238\n42634436032669\n91659921452940\n541453034568481\n379103522672315\n555689720604736\n132759062170768\n20346299669759\n285095936176573\n75365643884669\n238524319293110\n420903339435757\n334551123089634\n113762253792017\n28849956098160\n194797696966968\n57440169624766\n544810253201978\n436237035019730\n482781361879861\n451562898872753\n395879028348892\n121395935599089\n409431456319018\n154902071228101\n224635463987990\n459013953938681\n142670869874565\n282448069258152\n242382451120362\n17978883345856\n312070524637348\n509249001510454\n336550531120605\n420225858411694\n166872469098795\n554769014606773\n442084799525247\n112555026716453\n518399540637934\n167266744320249\n11629931904201\n313172360380743\n266675580438473\n489981067892109\n539983856126462\n40108126506885\n466597055011791\n293430577847972\n472762959360632\n441385832889494\n421905983310428\n398934722838607\n339061961403756\n225899065252817\n71937122920443\n119350445262324\n261403626362185\n486224612531414\n225971309674624\n473770813799428\n239548733721372\n435235155627578\n317885697957624\n361613326555781\n79814119607842\n459240120548328\n438955250274333\n220175009690700\n474694472577049\n318872451274205\n480338784671075\n270411228834924\n119054285786706\n348514924618706\n122354174726256\n464617525355901\n416113411057972\n420659618938099\n324487471873350\n533600567909712\n300307723453151\n112468187845819\n376164210917809\n26459568637185\n234667763068328\n330656966021309\n227128592895505\n432311421643340\n34030502774204\n437956683674722\n217413642330271\n75283583441064\n538895257967714\n119250975633432\n465464122849785\n239631273839922\n528823824074518\n470974372167650\n457264121923056\n145031905797091\n72730415213737\n106684985437402\n216605441143417\n457701708831003\n224519273459026\n75903444087925\n365475786184033\n122035276077927\n52166796219168\n546664440416045\n542053754220912\n324351452837800\n63702067734507\n243546103671323\n102770017086619\n462250185637793\n292472813603365\n562009114368012\n58620889775917\n138398280327120\n322144689531392\n42371902751795\n291727918325773\n285725217009853\n174366888517324\n366069369837793\n14937448831527";

    [Theory]
    [InlineData(SampleData, 3)]
    [InlineData(PuzzleData, 563)]
    public void Part1(string input, int expected)
    {
        var firstPart = input[..input.IndexOf("\n\n", StringComparison.InvariantCultureIgnoreCase)];
        var secondPart = input[(input.IndexOf("\n\n", StringComparison.InvariantCultureIgnoreCase) + 2)..];

        var intervals = firstPart.Split('\n')
            .Select(Interval.Parse)
            .ToList();

        var count = secondPart.Split('\n')
            .Select(long.Parse)
            .Count(id => intervals.Any(interval => interval.IsWithin(id)));

        Assert.Equal(expected, count);
    }

    [Theory]
    [InlineData(SampleData, 14)]
    [InlineData(PuzzleData, 338693411431456L)]
    public void Part2(string input, long expected)
    {
        var firstPart = input[..input.IndexOf("\n\n", StringComparison.InvariantCultureIgnoreCase)];

        var intervals = firstPart.Split('\n')
            .Select(Interval.Parse)
            .Aggregate(new List<Interval>(), Interval.Merge)
            .Select(interval => interval.Length)
            .Sum();

        Assert.Equal(expected, intervals);
    }

    public class Interval
    {
        public static Interval Parse(string input)
        {
            var splitted = input.Split('-');
            return new Interval
            {
                Start = long.Parse(splitted[0]),
                End = long.Parse(splitted[1]),
            };
        }

        public static List<Interval> Merge(List<Interval> intervals, Interval interval)
        {
            var result = new List<Interval> { interval };
            foreach (var i in intervals)
            {
                var interect = result.Where(r => r.Intersect(i)).ToList();
                foreach (var inter in interect)
                {
                    result.Remove(inter);
                }

                var merged = interect.Aggregate(i, (current, inter) => current.Merge(inter));
                result.Add(merged);
            }

            return result;
        }

        public required long End { get; init; }

        public required long Start { get; init; }
        public long Length => End - Start + 1;

        public bool IsWithin(long id)
        {
            return id >= Start && id <= End;
        }

        private Interval Merge(Interval other)
        {
            if (!Intersect(other))
                throw new ArgumentException(nameof(other));

            return new Interval
            {
                Start = Math.Min(Start, other.Start),
                End = Math.Max(End, other.End),
            };
        }

        private bool Intersect(Interval other)
        {
            return (other.Start >= Start && other.Start <= End)
                   || (other.End >= Start && other.End <= End)
                   || (other.Start <= Start && other.End >= End);
        }
    }
}
